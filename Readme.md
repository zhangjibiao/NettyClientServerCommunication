# Java部分

## 1.1 实现流程：

【树莓派】

1. 连接服务器。
2. 调用虹膜捕获Python程序.
3. 检测虹膜捕获程序的输出，当监听到输出为”Iris captured successfully“时，表明虹膜数据捕获完成。
4. 开始上传虹膜数据，等待服务器返回识别结果。

【服务器】

1. 等待树莓派连接。
2. 连接后建立传输通道。
3. 收到虹膜数据后，调用虹膜预测Python程序。
4. 检测虹膜预测程序输出，当监听到输出为“1”时，表明验证通过，为“0”时，表明验证不通过，继续监听，下一行输出为具体被识别对象的昵称，当验证不通过时，昵称为“unknown”
5. 根据识别结果，封装识别结果对象，返回给树莓派。
6. 等待下一次收到虹膜数据。

【树莓派】

5. 收到识别结果后，输出识别结果。
6. 继续监听虹膜捕获程序的输出，重复流程直至Esc按键被按下，按键被按下时，关闭通道，结束Python程序，结束本Java程序。

## 1.2 基于原理

Netty，**Netty**是一个[非阻塞I/O](https://zh.wikipedia.org/wiki/异步IO)客户端-服务器[框架](https://zh.wikipedia.org/wiki/軟體框架)， 是对 Java 原生的通信框架进行了高度的封装，支持TCP、HTTP、WebSocket等协议。Netty基于NIO，NIO基于SOCKET。

## 1.3 创新点

这个真不知道，有啥创新的，就单纯开发

## 1.4遇见的难点

当初连接通道后，能够发送图片，接收端也能收到图片，但是服务器程序会一直阻塞在等待接收图片阶段，无法判断图片是否接收完成，进而无法按时调用虹膜预测程序。

解决办法：抽象出Msg类，将所有消息从Msg继承，增加文件发送完成消息类，增加文件消息类（储存文件），服务端接收消息后，利用Java三大特性：多态，调用Msg对象的handle方法，让消息自己处理接下来的逻辑。如果是文件消息类，则显示接收情况，验证文件完整性；如果是文件发送完成类，则调用虹膜预测程序。